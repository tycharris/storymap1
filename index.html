<!DOCTYPE html>
<html lang="en">
<head>
    <title>Conflict</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--meta data for sharing links on Facebook-->
    <meta property="og:title" content="Conflict on Andes" />
    <!--<meta property="og:url" content="http://cdn.rawgit.com/paulomur/StoryMap_Conflict1/cda81462/index.html" /> -->
    <meta property="og:description" content="This is my storymap on Andes internal conflict " />

    <meta property="og:image" content="img/Thumbnail.PNG" />

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.2/dist/leaflet.css" />

    <!--animation-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">

    <!--facebook and info icons-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <!--use a better font for this web map    GO TO https://fonts.google.com/ TO GET MORE FONTS....  -->
    <link href="https://fonts.googleapis.com/css?family=Oswald" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="css/storymap.css">
    <!--add favicon for the web page-->
    <link rel="shortcut icon" href="img/co2.ico" type="image/x-icon">

    <!--add required libraries-->
    <script src="https://unpkg.com/leaflet@1.0.2/dist/leaflet.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-ajax/2.1.0/leaflet.ajax.min.js"></script>

    <!--story map plugin-->
    <script src="js/storymap.js"></script>

    <!-- bing map -->
    <script src="https://cdn.polyfill.io/v2/polyfill.min.js?features=Promise"></script>
    <script src="http://gmaclennan.github.io/leaflet-bing-layer/leaflet-bing-layer.js"></script>

    <!-- mini globle map -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/topojson/1.6.19/topojson.min.js"></script>
    <script src="js/globeminimap.js"></script>

</head>

<body>

<div class="container-fluid">
    <div class="row">
        <div class="col-sm-6 col-md-4 main">

            <section data-scene="overview">
                <video autoplay loop muted class="background-fullscreen-setting" playsinline autoplay muted loop>
                    <source src="assets/pueblo-sin-tierra_cutted2.mp4" type="video/mp4">
                </video>

                <!--<iframe class="background-img-setting text-responsive" src="https://www.youtube.com/embed/W0LHTWG-UmQ?controls=0&showinfo=0&rel=0&autoplay=1&loop=1&playlist=W0LHTWG-UmQ" frameborder="0" allowfullscreen></iframe>-->
                <div class= "background-fullscreen-setting text-responsive text-center" >
                    <h1><large style="color: white">Colombian Internal Conflict and displacement.
                        <br>
                        Forest disturbaces on National Parks.</large></h1>
                </div>
            </section>

            <section data-scene="scene1">
                <h2><large style="color: white">Amount of armed harassment over population.</large></h2>
                <h3>50 years of Colombian Internal Conflict.</h3>
                <br>
                <p>Colombian conflict is one of the longest worldwide internal conflicts during XX century. Although this conflict has taken place in rural and metropolitan areas, its repercussion has been more evident over rural sectors. Confrontations between governmental forces and illegal armed groups have generated internally displaced people especially on the south of Colombia. Direct harassment over population by Guerrilla and Paramilitary groups has been especially intense on rural zones, because of the structural fragilities of Colombian State, such as institutional weakness, social exclusion and inequality, centralization and the influence of narcotraffic and other criminal organizations over state institutions.
                </p>
                <img src="img/idps.png" class="img-responsive" alt="responsive image" alt-text="Routes">
                <p> Source:
                <a href="https://sites.google.com/a/stanford.edu/eessgisfall2013/group-projects/group-5">UNHDR-Stanford</a> </p>
            </section>

            <section data-scene="scene2">
                <h1><large style="color: black">Natural Parks over Andes region</large></h1>
                <p>Colombian National Parks are vital for preserving the planetâ€™s biodiversity and maintaining functional terrestrial and aquatic ecosystems. However, parks in the Colombian tropical Andes are under threat by anthropogenic process generating land forest conversion towards pastures and agriculture, which have led to deforestation and degradation of protected landscapes.</p>
                <img src="img/deforestation.jpg" class="img-responsive" alt="responsive image" alt-text="Routes">
                <p>Source:
                <a href="http://www.elespectador.com/noticias/medio-ambiente/los-siete-puntos-de-mayor-deforestacion-colombia-articulo-628404">elespectador.com.co</a></p>

            </section>

            <section data-scene="scene3">
                <h1><large style="color: black">National Park Picachos</large></h1>
                <p>Picachos is an example of how population incursion has generated affectation over protected forests. The armed conflict and the presence of illegal groups have caused IDP's (Internal desplaced people). Most IDP have moved towards big cities looking for life opportunities. In other cases IDP decide to stay in rural areas and some National Parks become into their new home.</p>
                <img src="img/desplazados.jpg" class="img-responsive" alt="responsive image" alt-text="Paramilitaries">
                <p>IDP's in Colombia.</p>
                <a href="https://www.arcoiris.com.co/2014/06/los-nuevos-focos-del-desplazamiento-forzado-en-colombia/">Source: Arcoiris.com.co </a></p>
                           </section>

            <section data-scene="scene4">
                <h1><large style="color: black">Cattle and Agricultural establisment</large></h1>
                <p>The presence of human populations in protected areas generates changes on land cover. Forest are cleared in favor of pastures expansion which modifies stable forests. Pastures are used to establish land-uses such as cattle and subsistence agriculture which are the main drivers of deforestation in this National Park.</p>
                <img src="img/vaca.jpg" class="img-responsive" alt="responsive image" alt-text="cows">
            </section>

            <section data-scene="end">
                <video autoplay loop muted class="background-fullscreen-setting" playsinline autoplay muted loop>
                    <source src="assets/colombia_cutted2.mp4" type="video/mp4">
                </video>
                <br/>
                <h3 class="">Thanks for watching!!!</h3>
                <h3><small style="color: rgba(169, 169, 169, 0.8)">Download Storymap.js from http://github.com/jakobzhao/storymap</small></h3>
            </section>


        </div>
        <!--add an arrow for scrolling down the texts-->
        <i class="animated zoomIn infinite glyphicon glyphicon-menu-down arrow-down"></i>
        <!--map div-->
        <div id="map" class="col-sm-6 col-md-8 sidebar"></div>
    </div>


    <dl>
        <dt>
            <!--facebook icon-->

            <a class="fa fa-facebook-square btn" href="https://facebook.com/sharer.php?u=http://cdn.rawgit.com/paulomur/StoryMap_Conflict1/cda81462/index.html" target="_blank"  ></a></dt>

        <dt>
            <!--info icon-->
            <i class="fa fa-info-circle btn" style="top:50px" data-toggle="modal" data-target="#info-modal"></i></dt>

        <dt>

        <a class="fa fa-github-square social3" style="left:97.6%;" href="https://github.com/cartobaldrica/water_atlas" target="_blank"></a> </dt>

    </dl>


    <ul class="navbar text-center"></ul>
    <div id="loading">
        <i class="animated zoomIn infinite glyphicon glyphicon-globe"></i>
    </div>


    <!--the info page-->
    <div class="modal fade" id="info-modal" role="dialog">
        <div class="modal-dialog modal-md">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">About</h4>
                </div>
                <div class="modal-body">
                    <p>This is a demo for the Visualization II class in Oregon State University. The story map library is derived from the storymap plugin for leaflet at <a>http://atlefren.github.io/storymap/</a>, and its functionality relies on both leaflet and Boostrap.</p>
                    <p><b>storymap.js</b> | Released Date: 04/24/2017 | Version: 2.1 | MIT License </p>
                    <p><b>Author: Paulo Murillo</b> | College of Earth, Ocean, Atmospheric Science | Oregon State University </p>
                    <p>This story map uses geospatial data from mapbox, Google Earth Engine, Microsoft Bing map, Open Street Maps and Oregon Explorer.</p>
                </div>
            </div>
        </div>
    </div>

</div>

!-- main javascript -->
<script type="text/javascript">

//THIS IS FOR SCENE 1  HARASSMENTS
    function setCountyColor(harassments){
        return harassments > 292 ? '#f8000c' :
            harassments > 220 ? '#ff6343':
                harassments > 140 ? '#ffa458':
                    harassments > 73 ? '#ffd58d':
                        '#fbffd5';
    }

    function style1(feature) {
        return {
            fillColor: setCountyColor(feature.properties.hosti2_Sum),
            fillOpacity: .8,
            color: '#303030',
            radius: 4,
            opacity: .7,
            weight: 1
        };
    }

    function highlightName(e) {
        var layer = e.target;

        layer.setStyle({
            fillOpacity: 1,
            weight: 2
        });
        layer.bringToFront();
    }

    function resetName(e) {
        var layer = e.target;

        layer.setStyle({
            fillOpacity: 0.8,
            weight: 1
        });
    }

    var h ='<p style ="font-weight: bold;">Amount of Harassments</p><i style="background: #f8000c; opacity: 0.8"></i><p>292+</p><i style="background: #ff6343; opacity: 0.8"></i><p>220 - 291</p><i style="background: #ffa458; opacity: 0.8"></i><p>140 - 219</p><i style="background: #ffefc1; opacity: 0.8"></i><p>73 - 139</p><i style="background: #fbffd5; opacity: 0.8"></i><p>0 - 72</p>'
    var parks_all = '<i style="background: #84ff42; fillOpacity: .8; weight: 1; opacity: 0.8; border:1px solid #fffff"></i><b><p style="text-align: left; margin-left: 25px">National Parks</b></p>';


    //THIS IS FOR SCENE 2  NATIONAL PARKS
    function critOpacity(string){
        if (string == "name") {return 0}
        else {return 0.8}
    }

    function critColor(string){
        if (string == "name") {return '#f8000c'}
        else {return '#84ff42'}
    }

    function critStyle(feature) {
        return {
            fillColor: critColor(feature.properties.name),
            fillOpacity: critOpacity(feature.properties.name),
            weight: 1.5,
            color: '#ffffff',
            opacity: critOpacity(feature.properties.name),
        };
    }

    function highlightFeature(e) {
        var layer = e.target;
        layer.bringToFront();
    }

    // Here I included many different basemaps taken from http://cdn.rawgit.com/jakobzhao/storymap/master/examples/tileLayer/index.html or https://github.com/jakobzhao/storymap/tree/master/examples/tileLayer
    //Additionally we can access to many different basemaps from https://leaflet-extras.github.io/leaflet-providers/preview/
    var layers = {
        'Microsoft Bing': [L.tileLayer.bing('AuhiCJHlGzhg93IqUH_oCpl_-ZUrIE6SPftlyGYUvr9Amx5nzA-WqGcPquyFZl4L')], // please apply for your own BING API KEY.
        'GEE Forest 2010': [ L.tileLayer('http://earthengine.google.org/static/hansen_2013/tree_alpha/{z}/{x}/{y}.png')],
        'Mapbox Satellite': [ L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiamFrb2J6aGFvIiwiYSI6ImNpcms2YWsyMzAwMmtmbG5icTFxZ3ZkdncifQ.P9MBej1xacybKcDN_jehvw', {
            id: 'mapbox.satellite'
        })],
        'Mapbox Light': [L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiamFrb2J6aGFvIiwiYSI6ImNpcms2YWsyMzAwMmtmbG5icTFxZ3ZkdncifQ.P9MBej1xacybKcDN_jehvw', {
            id: 'mapbox.light' // ,detectRetina: true
        })],
        'Mapbox Dark': [L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiamFrb2J6aGFvIiwiYSI6ImNpcms2YWsyMzAwMmtmbG5icTFxZ3ZkdncifQ.P9MBej1xacybKcDN_jehvw', {
            id: 'mapbox.dark' // ,detectRetina: true
        })],
        'Mapbox Outdoors': [L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiamFrb2J6aGFvIiwiYSI6ImNpcms2YWsyMzAwMmtmbG5icTFxZ3ZkdncifQ.P9MBej1xacybKcDN_jehvw', {
            id: 'mapbox.outdoors' // ,detectRetina: true
        })],
        'Mapbox Streets': [L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiamFrb2J6aGFvIiwiYSI6ImNpcms2YWsyMzAwMmtmbG5icTFxZ3ZkdncifQ.P9MBej1xacybKcDN_jehvw', {
            id: 'mapbox.streets' // ,detectRetina: true
        })],
        'NightView': [L.tileLayer('http://map1.vis.earthdata.nasa.gov/wmts-webmerc/VIIRS_CityLights_2012/default/{time}/{tilematrixset}{maxZoom}/{z}/{y}/{x}.{format}', {
            minZoom: 1,
            maxZoom: 8,
            format: 'jpg',
            time: '',
            tilematrixset: 'GoogleMapsCompatible_Level'})],
        'OpenStreetMap': [L.tileLayer('http://{s}.tile.openstreetmap.de/tiles/osmde/{z}/{x}/{y}.png')],

        'hosti': [ L.geoJson.ajax('assets/hosti.geojson',  {
            color: '#ff6b2a',
            weight: 2,
            opacity: 0.6}), '<i style="background: #ff6b2a; opacity: 1"></i><p><b>Parks</b></p>'],

        'hosti2': [L.geoJson.ajax('assets/hosti.geojson',
                {style:style1,
                    onEachFeature: function(feature, featureLayer) {
                    featureLayer.bindTooltip(feature.properties.admin2Name + " : "+feature.properties.hosti2_Sum, {className: 'label_tooltip'});
                    featureLayer.on({
                        mouseover: highlightName,
                        mouseout: resetName
                    })
                }}
            ), h],


        'parks_all': [ L.geoJson.ajax('assets/parks2.geojson',
            {style:critStyle, onEachFeature: function(feature, featureLayer) {
               // if (feature.properties.Type != 'REGION'){
                    featureLayer.bindTooltip(feature.properties.name, {className: 'label_tooltip'});
                    featureLayer.bindPopup(feature.properties.name, {className: 'label_tooltip'});
                    featureLayer.on({
                        add: highlightFeature,
                        mouseover: highlightName,
                        mouseout: resetName
                    })
                //}

            }}
        ), parks_all],


        'parks': [ L.geoJson.ajax('assets/parks2',  {
            color: '#44ff11',
            weight: 2,
            opacity: 0.6}), '<i style="background: #44ff11; opacity: 1"></i><p><b>National Parks</b></p>'],

        'picachos': [ L.geoJson.ajax('assets/picachos.geojson',  {
            color: '#e824ff',
            weight: 2,
            opacity: 0.5
        }),'<i style="background: #e824ff; opacity: 1"></i><p><b>Picachos National Park</b></p>'],

        'drivers': [ L.geoJson.ajax('assets/drivers.geojson',  {
            color: '#ff6b2a',
            weight: 3,
            opacity: 0.5

        }),'<i style="background: #ff6b2a; opacity: 1"></i><p><b>Deforestation</b></p>']
    };

    var scenes = {
        overview: {lat: 1, lng: -76, zoom: 7, position: 'fullpage', name: 'front page'},
        scene1: {lat: 4, lng: -76, zoom: 6, layers: ['Mapbox Dark', 'hosti2'], name: 's1'},
        scene2: {lat: 4, lng: -76, zoom: 7, layers: ['Mapbox Dark','parks_all'], name: 's2'},
        scene3: {lat: 2.8, lng: -74.8, zoom: 10, layers: ['Mapbox Outdoors','picachos', 'drivers'], name: 's3'},
        scene4: {lat: 2.8, lng: -74.8, zoom: 11, layers: ['Mapbox Streets','picachos', 'drivers'], name: 's4'},
        end: {lat: 2.8, lng: -74.8, zoom: 11, position: 'fullpage', name: 'last page'}
    };


    $('.main').storymap({
        scenes: scenes,
        layers: layers,
        legend: true, // if you do not want a legend feature, you can simply not define the createLegend function.
        scale: false,
        navbar: true,

        createMap: function () {
            // create a map in the "map" div, set the view to a given place and zoom /// TRUE MEANS we can use scroll mouse!!
            var map = L.map('map', {zoomControl: false, scrollWheelZoom: false});

            // add an base map, which can be either OSM, mapbox, tilelayer, wmslayer or those designed by yourself.
            L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiamFrb2J6aGFvIiwiYSI6ImNpcms2YWsyMzAwMmtmbG5icTFxZ3ZkdncifQ.P9MBej1xacybKcDN_jehvw', {
                maxZoom: 18,
                attribution: '<a href="http://ceoas.oregonstate.edu/profile/zhao/" target="_blank">Bo Zhao</a>',
                id: 'mapbox.light' // ,detectRetina: true
            }).addTo(map);


            // create a mini globe as the overview map control.
            var miniMap = new L.Control.GlobeMiniMap({
                marker:'orangered',
                position: 'bottomright'
            }).addTo(map);

            //* Add a button of zoom IN and OUT
            new L.Control.Zoom({ position: 'bottomright'}).addTo(map);

            // hidden the credits, but show in the about page.
            $(".leaflet-control-attribution").css("display", "none");

            return map;
        }
    });

</script>
</body>
</html>